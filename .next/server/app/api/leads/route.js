"use strict";(()=>{var e={};e.id=350,e.ids=[350],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},32694:e=>{e.exports=require("http2")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},35816:e=>{e.exports=require("process")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},42417:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>C,patchFetch:()=>x,requestAsyncStorage:()=>P,routeModule:()=>g,serverHooks:()=>m,staticGenerationAsyncStorage:()=>O});var s={};t.r(s),t.d(s,{DELETE:()=>h,GET:()=>A,OPTIONS:()=>w,POST:()=>T,PUT:()=>E});var o=t(49303),n=t(88716),a=t(60670),l=t(87070),i=t(93820),c=t(2188);let d="leads";async function u(){try{let e=(0,i.IO)((0,i.hJ)(c.db,d),(0,i.Xo)("createdAt","desc")),r=await (0,i.PL)(e),t=[];return r.forEach(e=>{let r=e.data();t.push({id:e.id,name:r.name,email:r.email,phone:r.phone,source:r.source||"main_site",sourceDetails:r.sourceDetails,submittedAt:r.submittedAt,message:r.message,status:r.status||"new",createdAt:r.createdAt})}),t}catch(e){return console.error("Error getting leads from Firestore:",e),[]}}async function p(e){try{return(await (0,i.ET)((0,i.hJ)(c.db,d),{...e,createdAt:new Date().toISOString()})).id}catch(e){throw console.error("Error saving lead to Firestore:",e),e}}async function A(){try{console.log("API request from","server",": /api/leads");let e=await u();return l.NextResponse.json(e,{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}catch(e){return console.error("Error fetching leads:",e),l.NextResponse.json({error:"Failed to fetch leads"},{status:500,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}}async function T(e){try{console.log("API request from","server",": /api/leads");let{name:r,email:t,phone:s,source:o,sourceDetails:n,message:a}=await e.json();if(!r||!t)return l.NextResponse.json({error:"Name and email are required"},{status:400});let i=new Date().toLocaleString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}),c={name:r,email:t,phone:s,source:o||"main_site",sourceDetails:n,submittedAt:i,message:a,status:"new",createdAt:new Date().toISOString()},d=await p(c);return l.NextResponse.json({success:!0,lead:{...c,id:d}},{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}catch(e){return console.error("Error saving lead:",e),l.NextResponse.json({error:"Failed to save lead"},{status:500,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}}async function E(e){try{console.log("API request from","server",": /api/leads (PUT)");let{id:r,status:s}=await e.json();if(!r)return l.NextResponse.json({error:"Lead ID is required"},{status:400});if(!s)return l.NextResponse.json({error:"Status is required"},{status:400});let{doc:o,updateDoc:n}=await Promise.resolve().then(t.bind(t,93820)),a=o(c.db,d,r);return await n(a,{status:s}),l.NextResponse.json({success:!0},{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}catch(e){return console.error("Error updating lead:",e),l.NextResponse.json({error:"Failed to update lead"},{status:500,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}}async function h(e){try{console.log("API request from","server",": /api/leads (DELETE)");let{searchParams:r}=new URL(e.url),s=r.get("id");if(!s)return l.NextResponse.json({error:"Lead ID is required"},{status:400});let{doc:o,deleteDoc:n}=await Promise.resolve().then(t.bind(t,93820)),a=o(c.db,d,s);return await n(a),l.NextResponse.json({success:!0},{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}catch(e){return console.error("Error deleting lead:",e),l.NextResponse.json({error:"Failed to delete lead"},{status:500,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}}async function w(){return new l.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type"}})}let g=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/leads/route",pathname:"/api/leads",filename:"route",bundlePath:"app/api/leads/route"},resolvedPagePath:"/Users/GabrielLeubitz/Downloads/igani/app/api/leads/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:P,staticGenerationAsyncStorage:O,serverHooks:m}=g,C="/api/leads/route";function x(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:O})}},2188:(e,r,t)=>{t.d(r,{db:()=>a});var s=t(29362),o=t(93820);let n=0===(0,s.C6)().length?(0,s.ZF)({apiKey:"AIzaSyAzn2artxg7S8ZANNwlVHTPq7bsqFbvE-A",authDomain:"igani-78bbc.firebaseapp.com",projectId:"igani-78bbc",storageBucket:"igani-78bbc.firebasestorage.app",messagingSenderId:"1058353839556",appId:"1:1058353839556:web:ffd347b4aedf7944d7f891",measurementId:"G-ZQEK0R7VTP"}):(0,s.C6)()[0],a=(0,o.ad)(n)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,999],()=>t(42417));module.exports=s})();